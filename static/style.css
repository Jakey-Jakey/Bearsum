/* static/style.css */

/* --- Variables --- */
:root {
    --font-primary: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    --font-secondary: 'Consolas', 'Monaco', 'Andale Mono', 'Ubuntu Mono', monospace; /* For code/raw text */

    /* Honey/Bear Theme Palette - Refined */
    --color-bg: #FEFBF3; /* Slightly warmer off-white */
    --color-surface: #FFFFFF;
    --color-text-primary: #3E2723; /* Darker, richer brown */
    --color-text-secondary: #6D4C41; /* Slightly darker secondary brown */
    --color-text-dark: #3E2723; /* Consistent dark brown */
    --color-accent-primary: #FFC107; /* Brighter, primary amber */
    --color-accent-secondary: #FFA000; /* Deeper amber for accents/hovers */
    --color-accent-strong: #FF8F00; /* Strong orange/honey for calls to action */
    --color-border-light: #FFE082; /* Lighter amber border */
    --color-border-medium: #D7CCC8; /* Neutral light brown border */
    --color-border-dark: #A1887F; /* Darker neutral border */
    --color-bg-light: #FFF8E1; /* Light creamy yellow (kept for subtle backgrounds) */
    --color-bg-subtle: #FAFAFA;
    --color-success-bg: #E8F5E9;
    --color-success-text: #1B5E20; /* Darker green for better contrast */
    --color-success-border: #A5D6A7;
    --color-error-bg: #FFEBEE;
    --color-error-text: #B71C1C; /* Darker red for better contrast */
    --color-error-border: #EF9A9A;
    --color-warning-bg: #FFF3E0;
    --color-warning-text: #E65100; /* Darker orange for better contrast */
    --color-warning-border: #FFCC80;

    --border-radius: 10px; /* Slightly larger radius for softer look */
    --box-shadow-light: 0 2px 8px rgba(0, 0, 0, 0.06);
    --box-shadow-medium: 0 4px 15px rgba(0, 0, 0, 0.1);
    --box-shadow-heavy: 0 6px 20px rgba(0, 0, 0, 0.12);
    --transition-speed: 0.25s;
    --transition-easing: ease-in-out;

    /* Subtle Honeycomb Pattern */
    --honeycomb-bg: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='23' viewBox='0 0 20 23'%3E%3Cg fill='%23FFA000' fill-opacity='0.05'%3E%3Cpath d='M10 0l10 5.77v11.54L10 23 0 17.31V5.77z'/%3E%3C/g%3E%3C/svg%3E");
}

/* --- Base & Typography --- */
body {
    font-family: var(--font-primary);
    margin: 0;
    padding: 0;
    background-color: var(--color-bg);
    /* Add subtle honeycomb pattern to body */
    background-image: var(--honeycomb-bg);
    color: var(--color-text-primary);
    line-height: 1.7; /* Increased for readability */
    font-size: 17px; /* Slightly larger base font size */
    -webkit-font-smoothing: antialiased; /* Smoother fonts */
    -moz-osx-font-smoothing: grayscale;
    overflow-x: hidden; /* Prevent horizontal scrollbars during minor transforms */
}

h1, h2, h3, h4 {
    color: var(--color-text-dark);
    line-height: 1.3;
    margin-bottom: 0.7em; /* Adjusted spacing */
    font-weight: 700; /* Bolder headings */
}
h1 { font-size: 2.5rem; letter-spacing: -0.5px; }
h2 { font-size: 1.8rem; margin-top: 2em; } /* More top margin for sections */
h3 { font-size: 1.4rem; font-weight: 600; }
h4 { font-size: 1.1rem; color: var(--color-text-secondary); font-weight: 600; }
p { margin-bottom: 1.2em; } /* More paragraph spacing */
a { color: var(--color-accent-strong); text-decoration: none; transition: color var(--transition-speed) var(--transition-easing); }
a:hover { color: var(--color-accent-secondary); text-decoration: underline; }

/* --- Layout --- */
.container {
    max-width: 900px; /* Wider for more space */
    margin: 2.5em auto; /* More top/bottom margin */
    padding: 2.5em 3em; /* Increased padding */
    background-color: var(--color-surface);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow-medium);
    position: relative; /* Needed for absolute positioning if used in animations */
}

.app-header {
    /* Gradient background */
    background: linear-gradient(135deg, var(--color-accent-primary) 0%, var(--color-accent-secondary) 100%);
    color: var(--color-text-dark);
    padding: 1.5em 0; /* More padding */
    text-align: center;
    margin-bottom: 3em; /* Increased spacing */
    border-bottom: 5px solid var(--color-accent-strong); /* Stronger bottom border */
    box-shadow: var(--box-shadow-light);
}
.app-header h1 { margin: 0; font-weight: 700; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }
.theme-accent { font-weight: 400; font-size: 0.8em; color: var(--color-text-primary); display: block; margin-top: 0.2em; }

.upload-section, .story-section {
    margin-bottom: 3em; /* Consistent larger spacing */
    padding-bottom: 2em; /* Add padding below section */
    border-bottom: 1px solid var(--color-border-medium); /* Separator line */
}
.upload-section:last-of-type, .story-section:last-of-type {
     border-bottom: none; /* No border for the last section */
     margin-bottom: 0; /* Adjust margin if needed */
}


/* --- Utility --- */
.visually-hidden { /* Hides element visually but keeps accessible */
  position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px;
  overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0;
}
/* Use JS to add/remove this class for visibility control */
.hidden {
    display: none !important;
}


/* --- Flash Messages --- */
.flash-messages { margin-bottom: 2em; }
.flash { padding: 1em 1.5em; margin-bottom: 1em; border-radius: 6px; border: 1px solid transparent; font-size: 0.95em; box-shadow: var(--box-shadow-light); }
.flash-success { color: var(--color-success-text); background-color: var(--color-success-bg); border-color: var(--color-success-border); }
.flash-error { color: var(--color-error-text); background-color: var(--color-error-bg); border-color: var(--color-error-border); }
.flash-warning { color: var(--color-warning-text); background-color: var(--color-warning-bg); border-color: var(--color-warning-border); }
.error-area { background-color: var(--color-error-bg); padding: 1.5em; border: 1px solid var(--color-error-border); border-radius: var(--border-radius); margin-top: 2em; }
.error-area h4 { margin-top: 0; color: var(--color-error-text); }

/* --- File Info Box --- */
.file-info {
    font-size: 0.9em; color: var(--color-text-secondary); margin-bottom: 2em; padding: 1em 1.5em;
    background-color: var(--color-bg-light); border-left: 5px solid var(--color-accent-primary); border-radius: 6px;
}

/* --- Upload Form & Drag Drop --- */
.upload-form { display: flex; flex-direction: column; gap: 2em; } /* Increased gap */
.upload-form .form-group { margin-bottom: 0; }
.upload-form label:not(.ghost-buttons label) {
    display: block; margin-bottom: 0.6em; font-weight: 600; color: var(--color-text-dark); font-size: 1.05em; /* Slightly larger labels */
}

/* Basic form control style */
.form-control {
    width: 100%; padding: 12px 15px; border-radius: var(--border-radius);
    border: 1px solid var(--color-border-medium); font-size: 1rem;
    box-sizing: border-box; /* Include padding in width */
    transition: border-color var(--transition-speed) ease-in-out, box-shadow var(--transition-speed) ease-in-out;
}
.form-control:focus {
    border-color: var(--color-accent-primary);
    outline: none;
    box-shadow: 0 0 0 3px rgba(255, 193, 7, 0.3); /* Focus ring */
}


.drop-zone {
    border: 3px dashed var(--color-border-medium);
    border-radius: var(--border-radius);
    padding: 3em 2em; /* Increased padding */
    text-align: center;
    cursor: pointer;
    background-color: var(--color-bg-subtle);
    transition: background-color var(--transition-speed) var(--transition-easing),
                border-color var(--transition-speed) var(--transition-easing),
                transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94); /* Smoother scale transition */
}
.drop-zone p { margin: 0.6em 0; color: var(--color-text-secondary); font-size: 1.1em; }
.drop-zone.dragover {
    background-color: var(--color-bg-light);
    border-color: var(--color-accent-strong);
    border-style: solid; /* Change border style on hover */
    transform: scale(1.015); /* Slightly more noticeable scale */
}
.btn-browse {
    display: inline-block; margin-top: 0.8em;
    background-color: var(--color-surface);
    color: var(--color-accent-strong);
    border: 2px solid var(--color-accent-secondary); /* Thicker border */
    padding: 10px 20px; /* More padding */
    border-radius: var(--border-radius);
    font-weight: 600;
    transition: all var(--transition-speed) var(--transition-easing);
}
.btn-browse:hover {
    background-color: var(--color-bg-light);
    border-color: var(--color-accent-strong);
    color: var(--color-text-dark);
    text-decoration: none;
    transform: translateY(-2px); /* Subtle lift */
    box-shadow: var(--box-shadow-light);
}

.file-list-display {
    margin-top: 1.5em; font-size: 0.9em; background-color: var(--color-surface);
    border: 1px solid var(--color-border-light); border-radius: 6px; padding: 1em 1.5em;
    min-height: 4em; box-shadow: inset 0 1px 4px rgba(0,0,0,0.04);
    transition: background-color var(--transition-speed) var(--transition-easing); /* Add transition */
}
.file-list-display ul { list-style: none; padding: 0; margin: 0; }
.file-list-display li {
    padding: 0.5em 0; border-bottom: 1px dashed var(--color-border-light);
    display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 0.5em;
    animation: fadeInItem 0.3s ease-out forwards; /* Simple fade-in */
    opacity: 0; /* Start hidden */
}
.file-list-display li:last-child { border-bottom: none; }
.file-list-display .file-size { color: var(--color-text-secondary); margin-left: 1em; font-size: 0.9em; white-space: nowrap; }
.file-list-display .file-error { color: var(--color-error-text); font-weight: bold; margin-left: 1em; font-size: 0.9em; }
.file-list-display li.has-error { background-color: var(--color-error-bg); padding-left: 10px; margin-left: -10px; border-radius: 4px;} /* More visible error highlight */

@keyframes fadeInItem {
    to {
        opacity: 1;
    }
}


/* --- Radio Button - Ghost Button Style --- */
.radio-group.ghost-buttons {
    display: flex; gap: 1em; flex-wrap: wrap;
}
.radio-group.ghost-buttons label { margin-right: 0; display: inline-block; }
.radio-group.ghost-buttons span {
    display: block; padding: 10px 20px; /* Increased padding */
    border: 2px solid var(--color-border-medium);
    border-radius: var(--border-radius); cursor: pointer;
    background-color: var(--color-surface); color: var(--color-text-secondary);
    transition: all var(--transition-speed) var(--transition-easing);
    font-weight: 600;
}
.radio-group.ghost-buttons label:hover span {
    border-color: var(--color-accent-secondary);
    background-color: var(--color-bg-light);
    color: var(--color-text-dark);
}
/* Style for the selected button */
.radio-group.ghost-buttons input[type="radio"]:checked + span {
    background: linear-gradient(135deg, var(--color-accent-primary) 0%, var(--color-accent-secondary) 100%); /* Gradient background */
    border-color: var(--color-accent-strong);
    color: var(--color-text-dark);
    font-weight: 700;
    box-shadow: var(--box-shadow-light);
}
/* Focus style for accessibility */
.radio-group.ghost-buttons input[type="radio"]:focus-visible + span {
     outline: 3px solid var(--color-accent-strong); /* More prominent outline */
     outline-offset: 3px;
}


/* --- Buttons (Refined Transitions) --- */
.btn {
    display: inline-block; padding: 14px 28px; /* Larger padding */
    border: none; border-radius: var(--border-radius);
    font-size: 1.05rem; font-weight: 600; text-decoration: none; cursor: pointer;
    transition: all 0.2s cubic-bezier(0.68, -0.55, 0.27, 1.55); /* Bouncier transition */
    text-align: center; box-shadow: var(--box-shadow-light);
}
.btn:hover {
    opacity: 0.9;
    box-shadow: var(--box-shadow-medium);
    transform: translateY(-3px) scale(1.02); /* More pronounced hover effect */
}
.btn:active {
    transform: translateY(0px) scale(0.98); /* Slight shrink on click */
    box-shadow: var(--box-shadow-light);
    opacity: 1;
}
.btn:disabled { opacity: 0.5; cursor: not-allowed; box-shadow: none; transform: none; background-image: none !important; background-color: var(--color-border-medium) !important; color: var(--color-text-secondary) !important; }

.btn-submit {
    background: linear-gradient(135deg, var(--color-accent-strong) 0%, var(--color-accent-secondary) 100%); /* Gradient */
    color: white; width: 100%; box-sizing: border-box; text-shadow: 1px 1px 1px rgba(0,0,0,0.2);
}
.btn-submit:hover { background: linear-gradient(135deg, var(--color-accent-secondary) 0%, var(--color-accent-strong) 100%); }

/* Specific style for story button */
#submit-button-story {
     background: linear-gradient(135deg, var(--color-text-secondary) 0%, var(--color-text-primary) 100%);
}
#submit-button-story:hover {
     background: linear-gradient(135deg, var(--color-text-primary) 0%, var(--color-text-secondary) 100%);
}


.btn-copy { background-color: var(--color-text-secondary); color: white; }
.btn-copy:hover { background-color: var(--color-text-dark); }

.btn-download { background-color: var(--color-border-dark); color: white; } /* Using darker neutral */
.btn-download:hover { background-color: var(--color-text-secondary); }

.action-buttons { margin-top: 2em; display: flex; gap: 1.2em; flex-wrap: wrap; }

/* --- Section Visibility Transition (SIMPLIFIED) --- */
.processing-indicator-wrapper,
.results-container-wrapper {
    transition: opacity var(--transition-speed) var(--transition-easing),
                transform var(--transition-speed) var(--transition-easing),
                visibility 0s linear var(--transition-speed); /* Hide visibility after transition */
                /* Removed max-height transition */
    opacity: 1;
    transform: translateY(0);
    overflow: visible; /* Allow content visibility during fade */
    visibility: visible;
}

/* Define the hidden state (SIMPLIFIED) */
.processing-indicator-wrapper.hidden,
.results-container-wrapper.hidden {
    opacity: 0;
    transform: translateY(15px); /* Keep slight translate */
    pointer-events: none;
    visibility: hidden;
    transition: opacity var(--transition-speed) var(--transition-easing),
                transform var(--transition-speed) var(--transition-easing),
                visibility 0s linear 0s; /* Make invisible immediately */
    /* Remove max-height, margin, padding, border overrides - rely on display:none equivalent via visibility */
    height: 0; /* Still useful to collapse space */
    overflow: hidden; /* Prevent content spill */
    margin: 0 !important; /* Ensure margin collapses */
    padding: 0 !important; /* Ensure padding collapses */
    border: none !important; /* Ensure border collapses */
}


/* --- Processing Indicator (Refined) --- */
.processing-indicator {
    /* Removed margin-top/bottom here, handled by wrapper */
    padding: 2.5em; background-color: var(--color-bg-light);
    border: 1px solid var(--color-border-light); border-radius: var(--border-radius);
    text-align: center; display: flex; flex-direction: column; align-items: center; gap: 1.5em;
    box-shadow: var(--box-shadow-medium);
}

.spinner {
    border: 8px solid var(--color-border-light); /* Thicker border */
    border-top: 8px solid var(--color-accent-strong);
    border-radius: 50%;
    width: 60px; /* Larger spinner */
    height: 60px;
    animation: spin 1.2s linear infinite;
     /* animation: spin 1.2s linear infinite, pulseBorder 2s ease-in-out infinite; */ /* Uncomment to add pulse */
}
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
/* Optional: Add a subtle pulse to the spinner border */
@keyframes pulseBorder {
    0%, 100% { border-color: var(--color-border-light); }
    50% { border-color: var(--color-accent-primary); }
}

.processing-indicator p#processing-task-name { margin: 0; font-size: 1.3em; color: var(--color-text-dark); font-weight: 600; }

/* Live Status Area - Animation for new messages */
.live-status-area {
    width: 100%; max-width: 650px; /* Wider */
    margin-top: 1.5em; background-color: var(--color-surface);
    border: 1px solid var(--color-border-medium); border-radius: 6px; padding: 1em 1.5em;
    text-align: center; box-shadow: inset 0 2px 5px rgba(0,0,0,0.06);
}
.live-status-area h4 { margin-top: 0; margin-bottom: 0.6em; font-size: 1em; color: var(--color-text-secondary); text-transform: uppercase; letter-spacing: 0.5px; }
p.latest-status-message {
    margin: 0; font-size: 1.05em; color: var(--color-text-primary); min-height: 1.4em; line-height: 1.5; font-weight: 600;
}

@keyframes fadeInStatus {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
/* Add a class to trigger the animation */
.latest-status-message.animate-new {
    animation: fadeInStatus 0.4s var(--transition-easing) forwards;
}


/* --- Results Area (Refined Transitions) --- */
.results-container {
     /* Removed margin-top/bottom here, handled by wrapper */
    padding-top: 2.5em;
    border-top: 2px solid var(--color-border-light); /* Thicker border */
    display: flex; flex-direction: column; gap: 3em;
}

.results-area { /* Style individual result sections */
     padding-bottom: 2em;
     border-bottom: 1px dashed var(--color-border-medium);
}
.results-area:last-child {
     border-bottom: none;
     padding-bottom: 0;
}


.results-area h2 {
    margin-top: 0; margin-bottom: 1.2em; color: var(--color-text-dark);
    border-bottom: 3px solid var(--color-accent-primary); /* Stronger underline */
    padding-bottom: 0.5em; display: inline-block; /* Fit underline to text */
}

/* View Toggle */
.view-toggle {
    margin-bottom: 1.8em; display: flex; gap: 0.8em;
    border-bottom: 2px solid var(--color-border-medium); /* Thicker line */
    padding-bottom: 1em;
}
.btn-toggle {
    padding: 10px 20px; font-size: 1rem; background-color: transparent;
    color: var(--color-text-secondary); border: none;
    border-bottom: 4px solid transparent; /* Thicker indicator */
    border-radius: 0; font-weight: 600; box-shadow: none;
    transition: color var(--transition-speed) var(--transition-easing), border-color var(--transition-speed) var(--transition-easing);
}
.btn-toggle.active {
    color: var(--color-accent-strong);
    border-bottom-color: var(--color-accent-strong);
    font-weight: 700;
}
.btn-toggle:hover:not(.active) {
    background-color: var(--color-bg-subtle);
    color: var(--color-text-dark);
    border-bottom-color: var(--color-border-light); /* Hint on hover */
}
.btn-toggle:active { transform: none; box-shadow: none; }

/* View Toggle Transition */
#summary-rendered,
#summary-raw {
    transition: opacity 0.3s var(--transition-easing), visibility 0.3s linear; /* Use linear for visibility */
    /* Ensure these are not hidden by default if they contain results */
    opacity: 1;
    visibility: visible;
    position: relative; /* Change back to relative if absolute causes issues */
    width: 100%;
    box-sizing: border-box;
}

#summary-rendered.hidden,
#summary-raw.hidden {
    opacity: 0;
    visibility: hidden; /* Use visibility for transition */
    /* position: absolute; */ /* Temporarily disable absolute positioning */
    /* width: calc(100% - 6em); */
    /* left: 3em; */
    pointer-events: none;
    height: 0; /* Collapse height when hidden */
    overflow: hidden; /* Hide content */
    margin: 0;
    padding: 0;
    border: none;
}

/* Wrapper to manage height for view toggle */
.summary-view-wrapper {
    position: relative;
    min-height: 100px; /* Estimate minimum height or calculate dynamically */
    transition: min-height 0.3s ease-in-out; /* Animate height change */
    margin-bottom: 1em; /* Add space below wrapper */
    overflow: hidden; /* Hide overflowing absolute children if used */
}


/* Rendered/Raw Views Styling */
.summary-rendered { /* Applies to both summary and story rendered views */
    line-height: 1.8; /* More spacing */
    color: var(--color-text-primary); padding: 1.5em 2em; /* More padding */
    border: 1px solid var(--color-border-medium); border-radius: var(--border-radius);
    background-color: var(--color-surface); box-shadow: var(--box-shadow-light);
}
.summary-rendered h1, .summary-rendered h2, .summary-rendered h3, .summary-rendered h4 {
    color: var(--color-text-dark); margin-top: 1.5em; margin-bottom: 0.8em;
    padding-bottom: 0.3em; border-bottom: 1px solid var(--color-border-light);
}
.summary-rendered h1:first-child, .summary-rendered h2:first-child, .summary-rendered h3:first-child, .summary-rendered h4:first-child { margin-top: 0; }
.summary-rendered p { margin-bottom: 1.2em; }
.summary-rendered ul, .summary-rendered ol { padding-left: 2.5em; margin-bottom: 1.2em; }
.summary-rendered li { margin-bottom: 0.5em; }
.summary-rendered code {
    background-color: var(--color-bg-light); padding: 0.3em 0.6em; /* More padding */
    border-radius: 4px; font-family: var(--font-secondary); /* Use secondary font */
    font-size: 0.9em; color: #BF360C; border: 1px solid var(--color-border-light);
}
.summary-rendered pre {
    background-color: var(--color-bg-subtle); border: 1px solid var(--color-border-medium);
    border-radius: 6px; padding: 1.2em; overflow-x: auto; font-size: 0.95em; /* Slightly larger */
    box-shadow: inset 0 1px 4px rgba(0,0,0,0.04);
}
.summary-rendered pre code { background-color: transparent; padding: 0; border-radius: 0; border: none; color: inherit; font-family: var(--font-secondary); }
.summary-rendered blockquote {
    border-left: 5px solid var(--color-accent-primary); margin-left: 0; padding-left: 1.5em;
    color: var(--color-text-secondary); font-style: italic; background-color: var(--color-bg-light);
    padding-top: 0.5em; padding-bottom: 0.5em; border-radius: 0 4px 4px 0;
}

.summary-raw pre {
    white-space: pre-wrap; word-wrap: break-word;
    background-color: var(--color-bg-subtle); padding: 1.5em; /* More padding */
    border: 1px solid var(--color-border-medium); border-radius: var(--border-radius);
    max-height: 600px; /* Increased max height */
    overflow-y: auto; color: var(--color-text-dark);
    font-family: var(--font-secondary); /* Use secondary font */
    font-size: 1rem; /* Slightly larger raw text */
    line-height: 1.6;
    box-shadow: inset 0 1px 4px rgba(0,0,0,0.04);
    margin: 0; /* Remove default margin */
}

/* Final Status Log (if shown - currently removed from HTML, but styled just in case) */
.status-section .status-log {
    background-color: var(--color-bg-subtle); border: 1px solid var(--color-border-medium);
    border-radius: var(--border-radius); padding: 1em 1.5em; max-height: 350px;
    overflow-y: auto; font-size: 0.9em; color: var(--color-text-secondary);
    box-shadow: var(--box-shadow-light);
}
.status-section .status-log ol { padding-left: 1.8em; margin: 0.8em 0; }
.status-section .status-log li { margin-bottom: 0.5em; padding-left: 0.4em; }
.status-section .status-log li::marker { color: var(--color-accent-primary); font-weight: bold; }

/* Accessibility: Respect Reduced Motion Preference */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
    animation-delay: -0.0001s !important; /* Try to force state jump */
  }
  .spinner { animation: none; }
  .drop-zone.dragover, .btn:hover, .btn:active { transform: none; }
  .latest-status-message.animate-new { animation: none; opacity: 1; transform: none; } /* Ensure status visible */
  /* Ensure simplified wrapper transitions are disabled */
  .processing-indicator-wrapper, .results-container-wrapper { transition: none; }
  .processing-indicator-wrapper.hidden, .results-container-wrapper.hidden {
      transform: none; opacity: 0; visibility: hidden; height: 0; margin: 0 !important; padding: 0 !important; border: none !important;/* Ensure hidden state */
   }
  .file-list-display li { animation: none; opacity: 1; } /* Ensure list items visible */
  .summary-view-wrapper { transition: none; } /* Disable height transition */
  #summary-rendered, #summary-raw { transition: none; } /* Disable view transition */
}

/* --- Tab Navigation --- */
.tab-navigation {
    display: flex;
    margin-bottom: 2em;
    border-bottom: 2px solid var(--color-border-medium);
    gap: 0.5em;
}

.tab-button {
    padding: 12px 20px;
    background-color: var(--color-bg-subtle);
    border: none;
    border-radius: var(--border-radius) var(--border-radius) 0 0;
    font-weight: 600;
    color: var(--color-text-secondary);
    cursor: pointer;
    transition: all var(--transition-speed) var(--transition-easing);
    border-bottom: 3px solid transparent;
    margin-bottom: -2px; /* Align with bottom border */
    position: relative; /* For the active indicator */
}

.tab-button:hover {
    background-color: var(--color-bg-light);
    color: var(--color-text-dark);
}

.tab-button.active {
    background-color: var(--color-accent-primary);
    color: var(--color-text-dark);
    border-bottom-color: var(--color-accent-strong);
}

.tab-content {
    transition: opacity 0.3s ease, transform 0.3s ease;
}

.tab-content.hidden {
    display: none;
}

/* --- Tab Content Animations --- */
@keyframes tabFadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes tabFadeOut {
    from { opacity: 1; transform: translateY(0); }
    to { opacity: 0; transform: translateY(-20px); }
}

.tab-fade-in {
    animation: tabFadeIn 0.3s ease forwards;
}

.tab-fade-out {
    animation: tabFadeOut 0.3s ease forwards;
}

/* --- Bear Toggle Easter Egg --- */
.bear-toggle {
    position: absolute;
    top: 0.5em;
    right: 0em;
    background: none;
    border: none;
    cursor: pointer;
    font-size: 2.2em; /* Bigger bear */
    transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55); /* Bouncier animation */
    line-height: 1;
    padding: 8px;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.3);
    z-index: 10; /* Ensure it's above other elements */
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    position: relative; /* Ensure relative positioning for tooltip */
}

.bear-toggle:hover {
    transform: scale(1.15) rotate(5deg); /* More noticeable hover effect */
    background-color: rgba(255, 255, 255, 0.5);
}

.bear-icon {
    display: inline-block;
    transition: all 0.3s ease;
}

.bear-toggle::after {
    content: 'Psst... click me!';
    position: absolute;
    bottom: -30px;
    right: 0;
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 5px 10px;
    border-radius: 5px;
    font-size: 0.5em;
    white-space: nowrap;
    opacity: 0;
    transform: translateY(10px);
    transition: opacity 0.3s ease, transform 0.3s ease;
    pointer-events: none;
}

.bear-toggle:hover::after {
    opacity: 1;
    transform: translateY(0);
}

/* Once clicked once, hide the tooltip in future sessions */
body.bear-tooltip-seen .bear-toggle::after {
    display: none;
}

/* Bear activation animation */
@keyframes bearActivate {
    0% { transform: scale(1) rotate(0); }
    25% { transform: scale(1.3) rotate(-15deg); }
    50% { transform: scale(1.2) rotate(15deg); }
    75% { transform: scale(1.3) rotate(-10deg); }
    100% { transform: scale(1) rotate(0); }
}

@keyframes bearDeactivate {
    0% { transform: scale(1) rotate(0); }
    25% { transform: scale(1.3) rotate(15deg); }
    50% { transform: scale(1.2) rotate(-15deg); }
    75% { transform: scale(1.3) rotate(10deg); }
    100% { transform: scale(1) rotate(0); }
}

.bear-activated .bear-icon {
    animation: bearActivate 1s forwards;
}

.bear-deactivated .bear-icon {
    animation: bearDeactivate 1s forwards;
}

/* --- New Task Button --- */
.btn-new-task {
    display: block;
    margin: 2em auto;
    padding: 12px 24px;
    background: linear-gradient(135deg, var(--color-text-secondary) 0%, var(--color-text-primary) 100%);
    color: white;
    border: none;
    border-radius: var(--border-radius);
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    box-shadow: var(--box-shadow-light);
    text-align: center;
}

.btn-new-task:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: var(--box-shadow-medium);
}

.btn-new-task:active {
    transform: translateY(1px) scale(0.98);
    box-shadow: var(--box-shadow-light);
}

.btn-new-task.hidden {
    display: none;
}

/* --- Dark Theme Variables --- */
:root {
    /* Keep existing variables */
    
    /* Dark Theme Variables */
    --dark-color-bg: #1A1A1A;
    --dark-color-surface: #242424;
    --dark-color-text-primary: #E6E6E6;
    --dark-color-text-secondary: #BBBBBB;
    --dark-color-text-dark: #FFFFFF;
    --dark-color-accent-primary: #FFC107; /* Keep amber as accent */
    --dark-color-accent-secondary: #FFA000;
    --dark-color-accent-strong: #FF8F00;
    --dark-color-border-light: #444444;
    --dark-color-border-medium: #666666;
    --dark-color-border-dark: #888888;
    --dark-color-bg-light: #333333;
    --dark-color-bg-subtle: #2A2A2A;
    --dark-color-success-bg: #1B5E20;
    --dark-color-success-text: #A5D6A7;
    --dark-color-success-border: #388E3C;
    --dark-color-error-bg: #B71C1C;
    --dark-color-error-text: #EF9A9A;
    --dark-color-error-border: #D32F2F;
    --dark-color-warning-bg: #E65100;
    --dark-color-warning-text: #FFCC80;
    --dark-color-warning-border: #EF6C00;
}

/* --- Dark Theme Implementation --- */
body.dark-theme {
    background-color: var(--dark-color-bg);
    color: var(--dark-color-text-primary);
}

/* Override background pattern for dark theme */
body.dark-theme {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='23' viewBox='0 0 20 23'%3E%3Cg fill='%23FFA000' fill-opacity='0.05'%3E%3Cpath d='M10 0l10 5.77v11.54L10 23 0 17.31V5.77z'/%3E%3C/g%3E%3C/svg%3E");
}

/* Storyteller tab specific dark theme */
body.dark-theme #storyteller-tab {
    /* Extra dark theme styling specifically for storyteller tab */
    --color-bg: var(--dark-color-bg);
    --color-surface: var(--dark-color-surface);
    --color-text-primary: var(--dark-color-text-primary);
    --color-text-secondary: var(--dark-color-text-secondary);
    --color-text-dark: var(--dark-color-text-dark);
    --color-border-light: var(--dark-color-border-light);
    --color-border-medium: var(--dark-color-border-medium);
    --color-border-dark: var(--dark-color-border-dark);
    --color-bg-light: var(--dark-color-bg-light);
    --color-bg-subtle: var(--dark-color-bg-subtle);
}

/* Container and card styling for dark theme */
body.dark-theme .container {
    background-color: var(--dark-color-surface);
    box-shadow: var(--box-shadow-medium);
}

body.dark-theme .app-header {
    background: linear-gradient(135deg, #8B5A00 0%, #FF8F00 100%);
    color: white;
    border-bottom-color: #FFA000;
}

body.dark-theme h1, 
body.dark-theme h2, 
body.dark-theme h3, 
body.dark-theme h4 {
    color: var(--dark-color-text-dark);
}

body.dark-theme a {
    color: var(--dark-color-accent-primary);
}

body.dark-theme a:hover {
    color: var(--dark-color-accent-secondary);
}

/* Form elements in dark theme */
body.dark-theme .drop-zone {
    border-color: var(--dark-color-border-medium);
    background-color: var(--dark-color-bg-subtle);
}

body.dark-theme .drop-zone p {
    color: var(--dark-color-text-secondary);
}

body.dark-theme .drop-zone.dragover {
    background-color: var(--dark-color-bg-light);
    border-color: var(--dark-color-accent-strong);
}

body.dark-theme .btn-browse {
    background-color: var(--dark-color-surface);
    color: var(--dark-color-accent-primary);
    border-color: var(--dark-color-accent-secondary);
}

body.dark-theme .btn-browse:hover {
    background-color: var(--dark-color-bg-light);
    color: var(--dark-color-text-dark);
    border-color: var(--dark-color-accent-strong);
}

body.dark-theme .file-list-display {
    background-color: var(--dark-color-surface);
    border-color: var(--dark-color-border-light);
}

body.dark-theme .file-list-display .file-size {
    color: var(--dark-color-text-secondary);
}

body.dark-theme .file-info {
    background-color: var(--dark-color-bg-light);
    border-left-color: var(--dark-color-accent-primary);
    color: var(--dark-color-text-secondary);
}

/* Ghost buttons in dark theme */
body.dark-theme .radio-group.ghost-buttons span {
    border-color: var(--dark-color-border-medium);
    background-color: var(--dark-color-surface);
    color: var(--dark-color-text-secondary);
}

body.dark-theme .radio-group.ghost-buttons label:hover span {
    border-color: var(--dark-color-accent-secondary);
    background-color: var(--dark-color-bg-light);
    color: var(--dark-color-text-dark);
}

body.dark-theme .radio-group.ghost-buttons input[type="radio"]:checked + span {
    background: linear-gradient(135deg, var(--dark-color-accent-primary) 0%, var(--dark-color-accent-secondary) 100%);
    border-color: var(--dark-color-accent-strong);
    color: var(--dark-color-text-dark);
}

/* Submit buttons in dark theme */
body.dark-theme .btn-submit {
    background: linear-gradient(135deg, var(--dark-color-accent-strong) 0%, var(--dark-color-accent-secondary) 100%);
}

body.dark-theme #submit-button-story {
    background: linear-gradient(135deg, var(--dark-color-text-secondary) 0%, var(--dark-color-text-primary) 100%);
}

/* Processing indicator in dark theme */
body.dark-theme .processing-indicator {
    background-color: var(--dark-color-bg-light);
    border-color: var(--dark-color-border-light);
}

body.dark-theme .live-status-area {
    background-color: var(--dark-color-surface);
    border-color: var(--dark-color-border-medium);
}

body.dark-theme .live-status-area h4 {
    color: var(--dark-color-text-secondary);
}

body.dark-theme p.latest-status-message {
    color: var(--dark-color-text-primary);
}

/* Results area in dark theme */
body.dark-theme .results-container {
    border-top-color: var(--dark-color-border-light);
}

body.dark-theme .results-area {
    border-bottom-color: var(--dark-color-border-medium);
}

body.dark-theme .results-area h2 {
    border-bottom-color: var(--dark-color-accent-primary);
}

body.dark-theme .view-toggle {
    border-bottom-color: var(--dark-color-border-medium);
}

body.dark-theme .btn-toggle {
    color: var(--dark-color-text-secondary);
}

body.dark-theme .btn-toggle.active {
    color: var(--dark-color-accent-primary);
    border-bottom-color: var(--dark-color-accent-primary);
}

body.dark-theme .btn-toggle:hover:not(.active) {
    background-color: var(--dark-color-bg-subtle);
    color: var(--dark-color-text-dark);
    border-bottom-color: var(--dark-color-border-light);
}

/* Summary/Story content in dark theme */
body.dark-theme .summary-rendered {
    color: var(--dark-color-text-primary);
    border-color: var(--dark-color-border-medium);
    background-color: var(--dark-color-surface);
}

body.dark-theme .summary-rendered h1, 
body.dark-theme .summary-rendered h2, 
body.dark-theme .summary-rendered h3, 
body.dark-theme .summary-rendered h4 {
    color: var(--dark-color-text-dark);
    border-bottom-color: var(--dark-color-border-light);
}

body.dark-theme .summary-rendered code {
    background-color: var(--dark-color-bg-light);
    color: #FFA726; /* Lighter orange for code */
    border-color: var(--dark-color-border-light);
}

body.dark-theme .summary-rendered pre {
    background-color: var(--dark-color-bg-subtle);
    border-color: var(--dark-color-border-medium);
}

body.dark-theme .summary-rendered blockquote {
    border-left-color: var(--dark-color-accent-primary);
    color: var(--dark-color-text-secondary);
    background-color: var(--dark-color-bg-light);
}

body.dark-theme .summary-raw pre {
    background-color: var(--dark-color-bg-subtle);
    border-color: var(--dark-color-border-medium);
    color: var(--dark-color-text-dark);
}

/* Action buttons in dark theme */
body.dark-theme .btn-copy {
    background-color: var(--dark-color-text-secondary);
    color: var(--dark-color-bg);
}

body.dark-theme .btn-copy:hover {
    background-color: var(--dark-color-text-dark);
}

body.dark-theme .btn-download {
    background-color: var(--dark-color-border-dark);
    color: var(--dark-color-bg);
}

body.dark-theme .btn-download:hover {
    background-color: var(--dark-color-text-secondary);
}

/* Tab navigation in dark theme */
body.dark-theme .tab-button {
    background-color: var(--dark-color-bg-subtle);
    color: var(--dark-color-text-secondary);
}

body.dark-theme .tab-button:hover {
    background-color: var(--dark-color-bg-light);
    color: var(--dark-color-text-dark);
}

body.dark-theme .tab-button.active {
    background-color: var(--dark-color-accent-primary);
    color: var(--dark-color-text-dark);
    border-bottom-color: var(--dark-color-accent-strong);
}

/* New task button in dark theme */
body.dark-theme .btn-new-task {
    background: linear-gradient(135deg, var(--dark-color-text-secondary) 0%, var(--dark-color-text-primary) 100%);
    color: var(--dark-color-bg);
}

/* Fix form inputs for dark theme */
body.dark-theme .form-control {
    background-color: var(--dark-color-surface);
    border-color: var(--dark-color-border-medium);
    color: var(--dark-color-text-primary);
}

body.dark-theme .form-control:focus {
    border-color: var(--dark-color-accent-primary);
    box-shadow: 0 0 0 3px rgba(255, 193, 7, 0.2);
}

/* Theme toggle appearance in dark theme */
body.dark-theme .bear-toggle {
    background-color: rgba(0, 0, 0, 0.3);
}

body.dark-theme .bear-toggle:hover {
    background-color: rgba(0, 0, 0, 0.5);
}

/* Special storyteller mode styling */
body.storyteller-mode .app-header {
    background: linear-gradient(135deg, #663300 0%, #996633 100%);
    box-shadow: 0 4px 20px rgba(102, 51, 0, 0.3);
}

body.storyteller-mode .bear-toggle {
    background-color: rgba(0, 0, 0, 0.4);
    box-shadow: 0 2px 10px rgba(255, 193, 7, 0.3);
}

body.storyteller-mode .bear-toggle:hover {
    background-color: rgba(0, 0, 0, 0.6);
}

body.storyteller-mode .container {
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    border: 1px solid var(--dark-color-border-medium);
}

/* Story result animation */
body.storyteller-mode .story-section h2 {
    position: relative;
    display: inline-block;
}

body.storyteller-mode .story-section h2::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, var(--dark-color-accent-primary), transparent);
    animation: storyTitleShine 3s ease-in-out infinite;
}

@keyframes storyTitleShine {
    0% { background-position: -100px; }
    50% { background-position: 200px; }
    100% { background-position: -100px; }
}

/* Enhanced Animations for Elements */

/* Buttons */
.btn {
    transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55) !important; /* Bouncier buttons */
}

.btn:hover {
    transform: translateY(-4px) scale(1.03) !important; /* More pronounced hover */
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15) !important;
}

.btn:active {
    transform: translateY(2px) scale(0.98) !important; /* More noticeable click */
}

/* Animated indicator for active tab */
.tab-button.active::after {
    content: '';
    display: block;
    position: absolute;
    bottom: -2px;
    left: 50%;
    width: 0;
    height: 3px;
    background-color: var(--color-accent-strong);
    transition: width 0.3s ease, left 0.3s ease;
    animation: tabActivate 0.3s forwards;
}

@keyframes tabActivate {
    from { width: 0; left: 50%; }
    to { width: 100%; left: 0; }
}

/* Processing spinner enhancement */
@keyframes spin {
    0% { transform: rotate(0deg); }
    50% { transform: rotate(180deg) scale(1.1); } /* Add scale for more dynamic spin */
    100% { transform: rotate(360deg); }
}

/* Add fancy animation to drop zone */
.drop-zone {
    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55) !important;
    position: relative;
    overflow: hidden;
}

.drop-zone::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0) 70%);
    transform: rotate(0deg);
    opacity: 0;
    transition: opacity 0.8s ease, transform 0.8s ease;
    pointer-events: none;
}

.drop-zone:hover::before {
    opacity: 0.4;
    transform: rotate(180deg);
}

.drop-zone.dragover::before {
    opacity: 0.6;
    transform: rotate(45deg);
}

/* Status message animation enhancement */
@keyframes fadeInStatus {
    from {
        opacity: 0;
        transform: translateY(10px) scale(0.9);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* Enhance ghost button animations */
.radio-group.ghost-buttons span {
    transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55) !important;
}

.radio-group.ghost-buttons label:hover span {
    transform: translateY(-3px);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}

.radio-group.ghost-buttons input[type="radio"]:checked + span {
    animation: selectedOption 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards;
}

@keyframes selectedOption {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

/* Input field focus animations */
.form-control:focus {
    animation: inputFocus 0.3s ease-out forwards;
}

@keyframes inputFocus {
    0% { transform: scale(1); }
    50% { transform: scale(1.02); }
    100% { transform: scale(1); }
}

/* Results section appear animation */
.results-container-wrapper:not(.hidden) {
    animation: resultsAppear 0.5s ease-out forwards;
}

@keyframes resultsAppear {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* New task button animations */
.btn-new-task:not(.hidden) {
    animation: newTaskAppear 0.5s ease-out forwards;
}

@keyframes newTaskAppear {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Ensure dark theme transitions are smooth */
body.dark-theme,
body.dark-theme * {
    transition-property: background-color, color, border-color, box-shadow, transform, opacity;
    transition-duration: 0.3s;
    transition-timing-function: ease;
}

/* Dark theme toggle animation */
body:not(.dark-theme) .bear-toggle,
body.dark-theme .bear-toggle {
    transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
}

/* Accessibility: Respect Reduced Motion Preference */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
    
    .bear-toggle:hover {
        transform: none !important;
    }
    
    .btn:hover, 
    .btn:active {
        transform: none !important;
    }
    
    .drop-zone::before {
        display: none !important;
    }
    
    .radio-group.ghost-buttons input[type="radio"]:checked + span {
        animation: none !important;
    }
    
    body.storyteller-mode .story-section h2::after {
        animation: none !important;
    }
}
/* Fix the text color in dark mode for the processing task name */
body.dark-theme #processing-task-name {
    color: var(--dark-color-text-primary);
}

/* Style for the tooltip reset indicator */
.tooltip-reset-indicator {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 10px 15px;
    border-radius: 5px;
    z-index: 9999;
    animation: fadeInOut 2s ease-in-out forwards;
    font-size: 14px;
}

.tooltip-reset-ready::after {
    content: 'Press refresh now to reset bear tooltip';
    position: fixed;
    top: 10px;
    right: 10px;
    background-color: var(--color-accent-primary);
    color: var(--color-text-dark);
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 12px;
    z-index: 9999;
}

@keyframes fadeInOut {
    0% { opacity: 0; transform: translateY(20px); }
    20% { opacity: 1; transform: translateY(0); }
    80% { opacity: 1; transform: translateY(0); }
    100% { opacity: 0; transform: translateY(-20px); }
}
